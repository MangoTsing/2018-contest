<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>2048</title>
</head>
<style>
	body{
		margin:0;
		padding: 0;
	}
	main{
		height: 500px;
		width: 500px;
		margin: 0 auto;
	}
	#container2{
		display: flex;
		flex-direction: row;
		height: 306px;
		width: 306px;
		opacity: 0.5;
		background: #50fc1a;
		flex-wrap:wrap;
		justify-content: center;
		
		/*outline: 0 none;*/
	}
	.item{
		height: 100px;
		width:100px;
		border: 1px solid yellow;
		background: blue;
		align-items:flex-start;
		-webkit-touch-callout: none; /* iOS Safari */

		-webkit-user-select: none; /* Chrome/Safari/Opera */

		-khtml-user-select: none; /* Konqueror */

		-moz-user-select: none; /* Firefox */

		-ms-user-select: none; /* Internet Explorer/Edge */

		user-select: none;
				/* 拖拽时禁止选中 */
	}
	.item1{
		height: 100px;
		width:100px;
		border: 1px solid yellow;
		background: yellow;
		align-items:flex-start;-webkit-touch-callout: none; /* iOS Safari */

		-webkit-user-select: none; /* Chrome/Safari/Opera */

		-khtml-user-select: none; /* Konqueror */

		-moz-user-select: none; /* Firefox */

		-ms-user-select: none; /* Internet Explorer/Edge */

		user-select: none;
		/* 拖拽时禁止选中 */
	}
	.item4{
		height: 100px;
		width:100px;
		border: 1px solid yellow;
		background: brown;
		align-items:flex-start;-webkit-touch-callout: none; /* iOS Safari */

		-webkit-user-select: none; /* Chrome/Safari/Opera */

		-khtml-user-select: none; /* Konqueror */

		-moz-user-select: none; /* Firefox */

		-ms-user-select: none; /* Internet Explorer/Edge */

		user-select: none;
		/* 拖拽时禁止选中 */
	}
</style>
<body>
	<main>
	
		<div class="main">
			<button id="btn">3*3</button>
			<button id="btn1">4*4</button>
			<button>5*5</button>
			<div class="container2" id="container2">
            
        	</div>
		</div>
	</main>
</body>
<script>

var oDiv=document.getElementById('container2');//容器
var oBtn=document.getElementById('btn');//按钮1
var oBtn1=document.getElementById('btn1');//按钮2
oBtn.addEventListener('click',handel,false);//game.start
oDiv.addEventListener('mousedown',LogicDown,false);//滑动效果
function handel(){

	
	for(var i=0;i<9;i++){
		oDiv.innerHTML+="<div class='item'></div>"
	}
	var oDivs=document.getElementsByClassName('item');
	let num=Math.round(Math.random()*8);//做两个随机数，用于第一次点击按钮
	let num0=Math.round(Math.random()*8);
	while(num==num0){
		num0=Math.round(Math.random()*8);
	}//取消重复可能性
	oDivs[num].classList.add('item1');
	oDivs[num0].classList.add('item1');
	//添加class
	var oDivm=document.getElementsByClassName('item1');
	//获取更改后的元素
	console.log(oDivm);
	for(let i=0;i<2;i++){
		let num1=Math.round(Math.random());//第一次数字为2或4
		if(num1){
		oDivm[i].innerHTML=2;
		}else{
			oDivm[i].innerHTML=4;
			oDivm[i].classList.add('item4');
		}
	}//为更改后的元素增加数字
	oBtn.removeEventListener('click',handel,false);
}

function LogicDown(event){
       var e = event || window.event;
       var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
       var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
       var x = e.pageX || e.clientX + scrollX;
       var y = e.pageY || e.clientY + scrollY;
		oDiv.onmouseup=function(event){
			 var e = event || window.event;
		       var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
		       var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
		       var x1 = e.pageX || e.clientX + scrollX;
		       var y1 = e.pageY || e.clientY + scrollY;
		       if(Math.abs(x-x1)>Math.abs(y-y1)&&(x-x1)<0){
		       	
		       	var oDivm=document.getElementsByClassName('item1');
		       	var oDivs=document.getElementsByClassName('item');
		       		for(let i=0;i<oDivs.length;i++){
		       			if(oDivs[i].classList.contains('item1')==true){
		       				
		       				if(i=='1'||i=='4'||i=='7'){
		       					// console.log(oDivs[i+1].innerHTML);
		       					if(oDivs[i+1].innerHTML==oDivs[i].innerHTML){//判断中间块的加法
		       						oDivs[i+1].innerHTML=oDivs[i].innerHTML*2;
		       						let oNum=oDivs[i+1].innerHTML;
		       						console.log(oNum);
		       						oDivs[i].classList.remove('item1');
					       			oDivs[i].classList.remove('item4');
					       			oDivs[i+1].classList.remove('item1');
					       			oDivs[i+1].classList.remove('item4');
		       						if(oNum=='2'||oNum=='8'){
					       				oDivs[i+1].className='item item1';
		       						}else if(oNum=='4'||oNum=='16'){
					       				oDivs[i+1].className='item item4';
		       						}
		       					}
		       					//重复class报错
		       				}else if(i=='2'||i=='5'||i=='8'){
		       				console.log('最右侧');
		       				}else if(i=='0'||i=='3'||i=='6'){

		       					if(oDivs[i+1].innerHTML==oDivs[i].innerHTML){//判断最左边块的加法
		       						oDivs[i+1].innerHTML=oDivs[i].innerHTML*2;
		       						let oNum=oDivs[i+1].innerHTML;
		       						console.log(oNum);
		       						oDivs[i].classList.remove('item1');
					       			oDivs[i].classList.remove('item4');
					       			oDivs[i+1].classList.remove('item1');
					       			oDivs[i+1].classList.remove('item4');
		       						if(oNum=='2'||oNum=='8'){
					       				oDivs[i+1].className='item item1';
		       						}else if(oNum=='4'||oNum=='16'){
					       				oDivs[i+1].className='item item4';
		       						}
		       					}else if(oDivs[i+2].innerHTML==oDivs[i].innerHTML&&!oDivs[i+1].innerHTML){
		       						oDivs[i+2].innerHTML=oDivs[i].innerHTML*2;
		       						let oNum=oDivs[i+2].innerHTML;
		       						console.log(oNum);
		       						oDivs[i].classList.remove('item1');
					       			oDivs[i].classList.remove('item4');
					       			oDivs[i+2].classList.remove('item1');
					       			oDivs[i+2].classList.remove('item4');
		       						if(oNum=='2'||oNum=='8'){
					       				oDivs[i+2].className='item item1';
		       						}else if(oNum=='4'||oNum=='16'){
					       				oDivs[i+2].className='item item4';
		       						}
		       					}

		       				}
		       			}
		       		}//以上右滑
		       }else if(Math.abs(x-x1)>Math.abs(y-y1)&&(x-x1)>0){
		       		var oDivm=document.getElementsByClassName('item1');
		       		var oDivs=document.getElementsByClassName('item');
		       		for(let i=0;i<oDivs.length;i++){
		       			if(oDivs[i].classList.contains('item1')==true){
		       				if(i=='1'||i=='4'||i=='7'){
		       					if(oDivs[i-1].innerHTML==oDivs[i].innerHTML){//判断中间块的加法
		       						oDivs[i-1].innerHTML=oDivs[i].innerHTML*2;
		       						let oNum=oDivs[i-1].innerHTML;
		       						console.log(oNum);
		       						oDivs[i].classList.remove('item1');
					       			oDivs[i].classList.remove('item4');
					       			oDivs[i-1].classList.remove('item1');
					       			oDivs[i-1].classList.remove('item4');
		       						if(oNum=='2'||oNum=='8'){
					       				oDivs[i-1].className='item item1';
		       						}else if(oNum=='4'||oNum=='16'){
					       				oDivs[i-1].className='item item4';
		       						}
		       					}
		       					//重复class报错
		       				}else if(i=='2'||i=='5'||i=='8'){
		       					if(oDivs[i-1].innerHTML==oDivs[i].innerHTML){//判断最右边块的加法
		       						oDivs[i-1].innerHTML=oDivs[i].innerHTML*2;
		       						let oNum=oDivs[i-1].innerHTML;
		       						console.log(oNum);
		       						oDivs[i].classList.remove('item1');
					       			oDivs[i].classList.remove('item4');
					       			oDivs[i-1].classList.remove('item1');
					       			oDivs[i-1].classList.remove('item4');
		       						if(oNum=='2'||oNum=='8'){
					       				oDivs[i-1].className='item item1';
		       						}else if(oNum=='4'||oNum=='16'){
					       				oDivs[i-1].className='item item4';
		       						}
		       					}else if(oDivs[i-2].innerHTML==oDivs[i].innerHTML&&!oDivs[i-1].innerHTML){
		       						//判断最右块加法，当中间为空时
		       							oDivs[i-2].innerHTML=oDivs[i].innerHTML*2;
			       						let oNum=oDivs[i-2].innerHTML;
			       						console.log(oNum);
			       						oDivs[i].classList.remove('item1');
						       			oDivs[i].classList.remove('item4');
						       			oDivs[i-2].classList.remove('item1');
						       			oDivs[i-2].classList.remove('item4');
			       						if(oNum=='2'||oNum=='8'){
						       				oDivs[i-2].className='item item1';
			       						}else if(oNum=='4'||oNum=='16'){
						       				oDivs[i-2].className='item item4';
			       						}
		       						}
		       				}else if(i=='0'||i=='3'||i=='6'){
		       					console.log('最左侧');
		       					

		       				}
		       			}
		       		}
		       }else if(Math.abs(x-x1)<Math.abs(y-y1)&&(y-y1)<0){
		       	console.log('bottom');
		       }else if(Math.abs(x-x1)<Math.abs(y-y1)&&(y-y1)>0){
		       	console.log('top');
		       }
		};
}

</script>
</html>